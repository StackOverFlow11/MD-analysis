# 代码架构（目录与数据流）

用途：记录“包打算怎么拆模块、数据怎么流动、每个目录放什么”，避免边写边变导致混乱。

## 适用体系前提（已与用户确认）

- 三基矢**正交**的周期性体系
- 始终包含**金属/水界面**
- 由于周期性边界条件，体系中总会存在**两个表面**（两个界面）

## 建议的顶层目录（将来在仓库根目录体现）

> 下面是建议结构，实际以你后续实现为准。

- `scripts/`：一次性脚本、实验脚本（可被后续代码替代）
- `src/` 或包目录（例如 `md_analysis/`）：正式库代码
- `tests/`：单元测试与样例数据最小子集
- `history/`：上下文与决策记录（本目录）
- `data_example/`：示例数据（用于开发/演示；如体积大，后续考虑只保留最小样例）

## 模块分层（建议）

- **I/O 层**：解析 CP2K 输出（ener/xyz/mulliken/cube），形成统一的内存数据结构
- **Core 数据模型**：Trajectory、Frame、System、Groups、Profiles（带单位/元数据）
- **Analysis 层**：密度/取向 profile、电势 profile、分组电荷统计、时间相关统计
- **Export 层**：csv/png + 元数据（json/yaml），保证可复现

## 数据流（建议）

1. 读取原始文件 → 2. 标准化与校验（单位/时间轴/缺失值）→ 3. 计算分析量 → 4. 导出结果与元数据

## 本目录子内容

- `modules/`：各模块的详细设计与接口草案
- `decisions/`：架构/技术决策（ADR），每条决策一份 md

