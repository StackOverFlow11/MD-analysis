&GLOBAL
  PROJECT md
  RUN_TYPE MD
  PRINT_LEVEL low
&END GLOBAL

&MOTION
  &MD  
    ENSEMBLE NVT
    STEPS 20000
    TIMESTEP 1.0
    TEMPERATURE 300.15
     &THERMOSTAT
       TYPE  NOSE
       REGION  GLOBAL
       &NOSE
         LENGTH               3
         TIMECON     2.2237606346543473E+01
       &END NOSE
     &END THERMOSTAT
     &PRINT
       &ENERGY  SILENT
       &END ENERGY
     &END PRINT
  &END MD

  &PRINT
     &TRAJECTORY  SILENT
       &EACH
         MD               5
       &END EACH
     &END TRAJECTORY
     &VELOCITIES  SILENT
       &EACH
         MD               5
       &END EACH
     &END VELOCITIES
     &RESTART  SILENT
       &EACH
         MD               10
       &END EACH
     &END RESTART
  &END PRINT
&END MOTION

&FORCE_EVAL
  METHOD Quickstep
  &DFT
     UKS  T
     CHARGE 0
     POTENTIAL_FILE_NAME  GTH_POTENTIALS
     BASIS_SET_FILE_NAME  BASIS_MOLOPT
     WFN_RESTART_FILE_NAME ./pt-RESTART.wfn

#    &POISSON
#     PERIODIC XYZ
#     POISSON_SOLVER wavelet #MT 
#    &END POISSON

    &MGRID
      CUTOFF 450
      NGRIDS 5
      REL_CUTOFF 60
    &END MGRID

    &QS
      EPS_DEFAULT 1.0E-12
      EPS_PGF_ORB 1.0E-6
      EXTRAPOLATION ASPC
      EXTRAPOLATION_ORDER 3 # find the best for your system
    &END QS

    &SCF
      EPS_SCF 1.0E-5
      MAX_SCF 60  
      SCF_GUESS RESTART

#       &OT
#         PRECONDITIONER FULL_ALL #change it when a bulk is too big
#         MINIMIZER  BROYDEN
#         BROYDEN_BETA     0.9
#         BROYDEN_SIGMA     0.1
#         LINESEARCH  2PNT
#       &END OT

#########################DIAGNOLIZATION METHOD##########################
      ADDED_MOS 100
      CHOLESKY INVERSE

      &SMEAR ON
        METHOD FERMI_DIRAC
      &END SMEAR

      &DIAGONALIZATION
        ALGORITHM STANDARD
      &END DIAGONALIZATION

      &MIXING ON
        METHOD BROYDEN_MIXING
          ALPHA 0.3
          BETA  1.5
          NBROYDEN 32
      &END MIXING
########################################################################

       &OUTER_SCF
         EPS_SCF 1.0E-5
         MAX_SCF 50
       &END OUTER_SCF
 
       &PRINT
          &RESTART_HISTORY
            FILENAME = MD_RESTART_HISTORY.wfn
            ADD_LAST NUMERIC
            BACKUP_COPIES 5
            &EACH
            &END EACH
          &END RESTART_HISTORY
      &END PRINT 
    &END SCF

    &XC
      &XC_FUNCTIONAL PBE
      &END XC_FUNCTIONAL

      &XC_GRID
        XC_SMOOTH_RHO NN10
        XC_DERIV NN10_SMOOTH
      &END XC_GRID

      &vdW_POTENTIAL
         POTENTIAL_TYPE PAIR_POTENTIAL
         &PAIR_POTENTIAL
            TYPE DFTD3
            PARAMETER_FILE_NAME dftd3.dat
            REFERENCE_FUNCTIONAL PBE
            R_CUTOFF 10.
         &END PAIR_POTENTIAL
      &END vdW_POTENTIAL 
    &END XC

    &PRINT
      &MULLIKEN  SILENT
        FILENAME =CHARGE.mulliken
        &EACH
           MD               5
        &END EACH
      &END MULLIKEN

      &V_HARTREE_CUBE SILENT
        FILENAME POTENTIAL
        STRIDE 8 8 1
        APPEND T
        &EACH
          MD 50
          GEO_OPT 0
        &END EACH
        ADD_LAST NUMERIC
      &END V_HARTREE_CUBE

    &END PRINT

  &END DFT



  &SUBSYS
    &CELL
      ABC [angstrom]   10.2239   10.2239   26.4220
      ALPHA_BETA_GAMMA 90.0000   90.0000   90.0000
      PERIODIC XYZ
    &END CELL

    &TOPOLOGY
      COORD_FILE_NAME init.xyz
      COORD_FILE_FORMAT xyz
    &END TOPOLOGY

#    &KIND C
#      BASIS_SET DZVP-MOLOPT-SR-GTH
#      POTENTIAL GTH-PBE-q4
#    &END KIND
    &KIND O
       BASIS_SET DZVP-MOLOPT-SR-GTH
       POTENTIAL GTH-PBE-q6
    &END KIND
    &KIND Cu
      BASIS_SET DZVP-MOLOPT-SR-GTH
      POTENTIAL GTH-PBE-q11
    &END KIND
    &KIND H
      BASIS_SET DZVP-MOLOPT-SR-GTH
      POTENTIAL GTH-PBE-q1
      MASS 2.0
    &END KIND
#    &KIND Zn
#      BASIS_SET DZVP-MOLOPT-SR-GTH
#      POTENTIAL GTH-PBE-q12
#    &END KIND
#    &KIND K
#      BASIS_SET DZVP-MOLOPT-SR-GTH
#      POTENTIAL GTH-PBE-q9
#    &END KIND
    &KIND Ag
      BASIS_SET DZVP-MOLOPT-SR-GTH
      POTENTIAL GTH-PBE-q11
    &END KIND

  &END SUBSYS
&END FORCE_EVAL





